(()=>{var e={};e.id=4639,e.ids=[4639],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},52825:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>c,pages:()=>p,routeModule:()=>m,tree:()=>d});var i=t(70260),s=t(28203),n=t(25155),a=t.n(n),l=t(67292),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(r,o);let d=["",{children:["retailer",{children:["marketplace",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,57404)),"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\retailer\\marketplace\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,62427)),"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\retailer\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,71354)),"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],p=["C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\retailer\\marketplace\\page.tsx"],c={require:t,loadChunk:()=>Promise.resolve()},m=new i.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/retailer/marketplace/page",pathname:"/retailer/marketplace",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},38555:(e,r,t)=>{Promise.resolve().then(t.bind(t,57404))},98643:(e,r,t)=>{Promise.resolve().then(t.bind(t,31208))},99905:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(41680).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},94889:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(41680).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},16873:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});let i=(0,t(41680).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},31208:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var i=t(45512),s=t(58009),n=t(65548),a=t(51965),l=t(99905),o=t(16873),d=t(94889);let p=(0,t(41680).A)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);var c=t(4643),m=t(28531),x=t.n(m);function g(){let{language:e,t:r}=(0,n.o)(),{showToast:t}=(0,a.d)(),[m,g]=(0,s.useState)([]),[u,f]=(0,s.useState)(!0),[y,b]=(0,s.useState)(""),[v,j]=(0,s.useState)({grade:"",type:"",minTrust:0}),[_,k]=(0,s.useState)(0),w=async()=>{f(!0);try{let e=new URLSearchParams({name:y,grade:v.grade,type:v.type}),r=await fetch(`/api/crops?${e}`),t=await r.json();g(t)}catch(e){console.error(e)}finally{setTimeout(()=>f(!1),500)}};return(0,i.jsxs)("div",{style:{paddingBottom:"3rem"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"var(--text-muted)",fontSize:"0.85rem",marginBottom:"1rem"},children:[(0,i.jsx)(x(),{href:"/retailer",style:{color:"inherit",textDecoration:"none"},children:r("sidebar_dashboard")}),(0,i.jsx)(l.A,{size:14}),(0,i.jsx)("span",{style:{color:"var(--primary-green)",fontWeight:"bold"},children:r("marketplace_title")})]}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",gap:"1rem"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:"2.5rem",fontWeight:"800",color:"var(--primary-green)",marginBottom:"0.5rem"},children:r("marketplace_title")}),(0,i.jsx)("p",{style:{color:"var(--text-muted)",fontSize:"1.1rem"},children:r("retailer_desc")})]})})]}),(0,i.jsx)("div",{className:"card",style:{marginBottom:"2.5rem",padding:"1.5rem",background:"white",borderRadius:"20px",boxShadow:"0 10px 30px rgba(0,0,0,0.03)"},children:(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[(0,i.jsxs)("div",{style:{flex:1,minWidth:"300px",position:"relative"},children:[(0,i.jsx)(o.A,{size:20,style:{position:"absolute",left:"1rem",top:"50%",transform:"translateY(-50%)",color:"#94a3b8"}}),(0,i.jsx)("input",{type:"text",placeholder:r("search_crop_hint"),value:y,onChange:e=>b(e.target.value),style:{width:"100%",padding:"1rem 1rem 1rem 3rem",borderRadius:"12px",border:"2px solid #f1f5f9",background:"#f8fafc",transition:"all 0.3s"}})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsxs)("select",{value:v.grade,onChange:e=>j({...v,grade:e.target.value}),style:{padding:"0.85rem 2.5rem 0.85rem 1rem",borderRadius:"12px",border:"2px solid #f1f5f9",background:"#f8fafc",appearance:"none",fontWeight:"500"},children:[(0,i.jsx)("option",{value:"",children:r("all_grades")}),(0,i.jsx)("option",{value:"A",children:r("grade_a")}),(0,i.jsx)("option",{value:"B",children:r("grade_b")}),(0,i.jsx)("option",{value:"C",children:r("grade_c")})]}),(0,i.jsx)(l.A,{size:16,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%) rotate(90deg)",pointerEvents:"none",color:"#64748b"}})]}),(0,i.jsxs)("div",{style:{position:"relative"},children:[(0,i.jsxs)("select",{value:v.type,onChange:e=>j({...v,type:e.target.value}),style:{padding:"0.85rem 2.5rem 0.85rem 1rem",borderRadius:"12px",border:"2px solid #f1f5f9",background:"#f8fafc",appearance:"none",fontWeight:"500"},children:[(0,i.jsx)("option",{value:"",children:r("all_bid_types")}),(0,i.jsx)("option",{value:"BULK",children:r("bulk_bids")}),(0,i.jsx)("option",{value:"MINI",children:r("mini_bids")})]}),(0,i.jsx)(l.A,{size:16,style:{position:"absolute",right:"1rem",top:"50%",transform:"translateY(-50%) rotate(90deg)",pointerEvents:"none",color:"#64748b"}})]}),(0,i.jsxs)("button",{onClick:w,className:"btn-primary",style:{padding:"0 2rem",borderRadius:"12px",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsx)(d.A,{size:18})," ",r("apply_btn")]})]})]})}),u?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"5rem 0"},children:[(0,i.jsx)("div",{className:"animate-spin",style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid var(--primary-green)",borderRadius:"50%",margin:"0 auto 1.5rem auto"}}),(0,i.jsx)("p",{style:{color:"var(--text-muted)",fontWeight:"500"},children:r("loading_marketplace")})]}):0===m.filter(e=>new Date(e.biddingEndTime).getTime()>_).length?(0,i.jsxs)("div",{className:"card animate-fade",style:{textAlign:"center",padding:"5rem 2rem",background:"white",borderRadius:"24px"},children:[(0,i.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1.5rem"},children:"\uD83C\uDF3E"}),(0,i.jsx)("h2",{style:{marginBottom:"1rem"},children:r("no_matching_crops")}),(0,i.jsx)("p",{style:{color:"var(--text-muted)"},children:r("adjust_filters")})]}):(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:"2rem"},children:m.filter(e=>new Date(e.biddingEndTime).getTime()>_).map(s=>{let n=!(new Date(s.biddingStartTime).getTime()<=_);return(0,i.jsxs)("div",{className:"card stat-card-hover animate-fade",style:{display:"flex",flexDirection:"column",opacity:n?.9:1,padding:"1.5rem",borderRadius:"24px",border:"none",background:"white"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1.25rem",alignItems:"center"},children:[(0,i.jsxs)("span",{style:{padding:"0.4rem 0.8rem",borderRadius:"100px",fontSize:"0.75rem",fontWeight:"800",background:"BULK"===s.biddingType?"#eff6ff":"#f0fdf4",color:"BULK"===s.biddingType?"#1e40af":"#166534",display:"flex",alignItems:"center",gap:"0.4rem"},children:[(0,i.jsx)(p,{size:14})," ",s.biddingType]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem",color:n?"#f59e0b":"#ef4444",fontSize:"0.85rem",fontWeight:"700"},children:[(0,i.jsx)(c.A,{size:16}),(0,i.jsxs)("span",{children:[n?r("starts_in"):r("ends_in_label"),": ",function(e,r){let t=new Date(e).getTime()-Date.now();if(t<=0)return"0h 0m";let i=Math.floor(t/36e5),s=Math.floor(t%36e5/6e4);return"hi"===r?`${i}घं ${s}मि`:"kn"===r?`${i}ಗಂ ${s}ನಿ`:`${i}h ${s}m`}(n?s.biddingStartTime:s.biddingEndTime,e)]})]})]}),(0,i.jsx)("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem",color:"#1e293b"},children:s.name}),(0,i.jsxs)("div",{style:{display:"flex",gap:"1.5rem",marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:r("quality_grade_label")}),(0,i.jsx)("span",{style:{fontWeight:"800",color:"var(--primary-green)",fontSize:"1.1rem"},children:s.qualityGrade})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)("span",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:r("total_quantity_label")}),(0,i.jsxs)("span",{style:{fontWeight:"800",color:"#1e293b",fontSize:"1.1rem"},children:[s.availableQuantity," kg"]})]})]}),(0,i.jsxs)("div",{style:{background:"#f8fafc",padding:"1.25rem",borderRadius:"16px",marginBottom:"1.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.75rem"},children:[(0,i.jsxs)("span",{style:{fontSize:"0.9rem",color:"#64748b"},children:[r("min_price_label_short"),":"]}),(0,i.jsxs)("span",{style:{fontWeight:"bold"},children:["₹",s.minPrice,"/kg"]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--primary-green)"},children:[(0,i.jsxs)("span",{style:{fontSize:"0.9rem",fontWeight:"700"},children:[r("current_highest"),":"]}),(0,i.jsxs)("span",{style:{fontWeight:"900",fontSize:"1.25rem"},children:["₹",s.bids?.[0]?.pricePerKg||s.minPrice,"/kg"]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1.5rem",padding:"1rem",background:"#f0fdf4",borderRadius:"12px",border:"1px solid #dcfce7"},children:[(0,i.jsx)("div",{style:{width:"40px",height:"40px",background:"white",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 6px rgba(0,0,0,0.05)"},children:"\uD83D\uDC68‍\uD83C\uDF3E"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"0.8rem",fontWeight:"700",color:"#166534"},children:r("farmer_trust_score")}),(0,i.jsxs)("div",{style:{color:"var(--primary-green)",fontSize:"0.9rem",fontWeight:"800"},children:[s.farmer.user.trustScore,"% ",r("verified_label")]})]})]}),(0,i.jsx)("div",{style:{marginTop:"auto"},children:n?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"1.25rem",background:"#f1f5f9",borderRadius:"14px",color:"#475569",fontSize:"1rem",fontWeight:"700",border:"1px dashed #cbd5e1",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem"},children:[(0,i.jsx)(c.A,{size:20})," ",r("bidding_starts_at")," ",new Date(s.biddingStartTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):(0,i.jsx)(h,{crop:s,onBidSuccess:w,t:r,showToast:t})})]},s.id)})})]})}function h({crop:e,onBidSuccess:r,t,showToast:n}){let[a,l]=(0,s.useState)("BULK"===e.biddingType?e.availableQuantity:1),[o,d]=(0,s.useState)(e.minPrice+1),[p,c]=(0,s.useState)(!1),m=async()=>{c(!0);try{let i=await fetch("/api/bids",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cropId:e.id,quantity:Number(a),pricePerKg:Number(o)})}),s=await i.json();i.ok?(n(t("bid_success"),"success"),r()):n(s.error||"Failed","error")}catch(e){console.error(e),n("An error occurred","error")}finally{c(!1)}};return(0,i.jsxs)("div",{style:{marginTop:"auto"},children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.4rem"},children:[(0,i.jsx)("label",{style:{fontSize:"0.8rem",fontWeight:"800",color:"#64748b",paddingLeft:"0.25rem"},children:t("qty_kg")}),(0,i.jsx)("input",{type:"number",value:a,onChange:e=>l(Number(e.target.value)),disabled:"BULK"===e.biddingType,style:{width:"100%",padding:"0.85rem",borderRadius:"12px",border:"2px solid #f1f5f9",background:"BULK"===e.biddingType?"#f1f5f9":"white",fontWeight:"800"}})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.4rem"},children:[(0,i.jsx)("label",{style:{fontSize:"0.8rem",fontWeight:"800",color:"#64748b",paddingLeft:"0.25rem"},children:t("price_per_kg")}),(0,i.jsx)("input",{type:"number",value:o,onChange:e=>d(Number(e.target.value)),style:{width:"100%",padding:"0.85rem",borderRadius:"12px",border:"2px solid #f1f5f9",fontWeight:"800"}})]})]}),(0,i.jsx)("button",{onClick:m,className:"btn-primary",style:{width:"100%",padding:"1rem",borderRadius:"14px",fontSize:"1rem",fontWeight:"800",boxShadow:"0 4px 12px rgba(34, 197, 94, 0.2)"},disabled:p,children:p?t("placing_bid"):t("place_bid_btn")})]})}},57404:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});let i=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\pprit\\\\OneDrive\\\\Desktop\\\\hgmodel\\\\src\\\\app\\\\retailer\\\\marketplace\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\retailer\\marketplace\\page.tsx","default")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[638,6650,8531,9966,9769],()=>t(52825));module.exports=i})();