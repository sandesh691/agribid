(()=>{var e={};e.id=6426,e.ids=[6426],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},14089:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>l});var s=t(70260),i=t(28203),n=t(25155),a=t.n(n),o=t(67292),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(r,d);let l=["",{children:["farmer",{children:["crops",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,51589)),"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\farmer\\crops\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,96048)),"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\farmer\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,71354)),"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\farmer\\crops\\[id]\\page.tsx"],p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/farmer/crops/[id]/page",pathname:"/farmer/crops/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},68081:(e,r,t)=>{Promise.resolve().then(t.bind(t,51589))},83761:(e,r,t)=>{Promise.resolve().then(t.bind(t,29705))},29705:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(45512),i=t(58009),n=t(79334),a=t(51965),o=t(22447);function d(){let{id:e}=(0,n.useParams)(),{showToast:r}=(0,a.d)(),{showModal:t}=(0,o.h)(),[d,l]=(0,i.useState)(null),[c,p]=(0,i.useState)(!0),[m,u]=(0,i.useState)(!1);(0,n.useRouter)();let h=async()=>{try{let r=await fetch(`/api/crops/details?id=${e}`),t=await r.json();l(t)}catch(e){console.error(e)}finally{p(!1)}},x=async e=>{t({title:"Accept this bid?",message:"Once accepted, this bid will be finalized and a transaction record will be created. This action cannot be undone.",type:"confirm",confirmText:"Yes, Accept Bid",cancelText:"No, Go Back",onConfirm:async()=>{u(!0);try{let t=await fetch(`/api/bids/${e}/accept`,{method:"POST"}),s=await t.json();t.ok?(r("Bid accepted successfully!","success"),h()):r(s.error||"Failed to accept bid","error")}catch(e){r("An error occurred","error")}finally{u(!1)}}})};return c?(0,s.jsx)("div",{children:"Loading crop bids..."}):d?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"card",style:{marginBottom:"2rem"},children:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{style:{marginBottom:"0.5rem"},children:d.name}),(0,s.jsxs)("div",{style:{display:"flex",gap:"1rem",color:"var(--text-muted)"},children:[(0,s.jsxs)("span",{children:["Listed: ",new Date(d.biddingStartTime).toLocaleDateString()]}),(0,s.jsxs)("span",{children:["Available: ",(0,s.jsxs)("strong",{children:[d.availableQuantity," / ",d.totalQuantity," kg"]})]}),(0,s.jsxs)("span",{children:["Status: ",(0,s.jsx)("strong",{style:{color:"ACTIVE"===d.status?"var(--primary-green)":"red"},children:d.status})]})]})]}),(0,s.jsxs)("div",{style:{textAlign:"right"},children:[(0,s.jsx)("div",{style:{fontSize:"0.9rem",color:"var(--text-muted)"},children:"Min Price"}),(0,s.jsxs)("div",{style:{fontSize:"1.25rem",fontWeight:"bold"},children:["₹",d.minPrice,"/kg"]})]})]})}),(0,s.jsxs)("h3",{style:{marginBottom:"1rem"},children:["Active Bids (",d.bids.length,")"]}),0===d.bids.length?(0,s.jsx)("div",{className:"card",style:{textAlign:"center",padding:"3rem"},children:(0,s.jsx)("p",{children:"No bids received yet."})}):(0,s.jsx)("div",{style:{display:"grid",gap:"1rem"},children:d.bids.map(e=>(0,s.jsxs)("div",{className:"card",style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderLeft:"ACCEPTED"===e.status?"4px solid var(--primary-green)":"none"},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.25rem"},children:[(0,s.jsxs)("span",{style:{fontSize:"1.1rem",fontWeight:"bold"},children:["₹",e.pricePerKg,"/kg"]}),(0,s.jsxs)("span",{className:"badge badge-active",children:[e.quantity," kg"]}),(0,s.jsxs)("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:["Total: ₹",e.pricePerKg*e.quantity]})]}),(0,s.jsxs)("div",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:["Bidder: ",(0,s.jsx)("strong",{children:e.retailer?.retailerProfile?.businessName||"Unknown"})," • Trust Score: ",(0,s.jsxs)("strong",{style:{color:"var(--primary-green)"},children:[e.retailer.trustScore,"%"]})," • ",new Date(e.timestamp).toLocaleString()]}),"ACCEPTED"===e.status&&(0,s.jsx)("div",{style:{color:"var(--primary-green)",fontWeight:"bold",marginTop:"0.5rem"},children:"✅ ACCEPTED"})]}),"PENDING"===e.status&&"ACTIVE"===d.status&&(0,s.jsx)("button",{onClick:()=>x(e.id),className:"btn-primary",disabled:m||d.availableQuantity<e.quantity,children:"Accept Bid"})]},e.id))})]}):(0,s.jsx)("div",{children:"Crop not found."})}},51589:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\pprit\\\\OneDrive\\\\Desktop\\\\hgmodel\\\\src\\\\app\\\\farmer\\\\crops\\\\[id]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\pprit\\OneDrive\\Desktop\\hgmodel\\src\\app\\farmer\\crops\\[id]\\page.tsx","default")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,6650,8531,9966,7931],()=>t(14089));module.exports=s})();